!function(){"use strict";var e={705:function(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",i=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),i&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),i&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,i,n,r){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var d=this[o][0];null!=d&&(a[d]=!0)}for(var c=0;c<e.length;c++){var l=[].concat(e[c]);i&&a[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=r),s&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=s):l[2]=s),n&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=n):l[4]="".concat(n)),t.push(l))}},t}},738:function(e){e.exports=function(e){return e[1]}},745:function(e,t,s){var i=s(738),n=s.n(i),r=s(705),a=s.n(r)()(n());a.push([e.id,"",""]),t.Z=a},379:function(e){var t=[];function s(e){for(var s=-1,i=0;i<t.length;i++)if(t[i].identifier===e){s=i;break}return s}function i(e,i){for(var r={},a=[],o=0;o<e.length;o++){var d=e[o],c=i.base?d[0]+i.base:d[0],l=r[c]||0,u="".concat(c," ").concat(l);r[c]=l+1;var h=s(u),f={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==h)t[h].references++,t[h].updater(f);else{var p=n(f,i);i.byIndex=o,t.splice(o,0,{identifier:u,updater:p,references:1})}a.push(u)}return a}function n(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,n){var r=i(e=e||[],n=n||{});return function(e){e=e||[];for(var a=0;a<r.length;a++){var o=s(r[a]);t[o].references--}for(var d=i(e,n),c=0;c<r.length;c++){var l=s(r[c]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}r=d}}},569:function(e){var t={};e.exports=function(e,s){var i=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},216:function(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:function(e,t,s){e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},795:function(e){e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,n&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:function(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,s),r.exports}s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var t=s(379),i=s.n(t),n=s(795),r=s.n(n),a=s(569),o=s.n(a),d=s(565),c=s.n(d),l=s(216),u=s.n(l),h=s(589),f=s.n(h),p=s(745),g={};g.styleTagTransform=f(),g.setAttributes=c(),g.insert=o().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=u(),i()(p.Z,g),p.Z&&p.Z.locals&&p.Z.locals,new class{constructor(){e(this,"endpoint","https://mid.4sitestudios.com/address-standardize/"),e(this,"wasCalled",!1),e(this,"isDirty",!1),e(this,"cid",0),e(this,"as_record",""),e(this,"as_date",""),e(this,"as_status",""),e(this,"fields",{address1:"supporter.address1",address2:"supporter.address2",city:"supporter.city",region:"supporter.region",postalCode:"supporter.postcode",country:"supporter.country"}),this.isDebug()&&console.log("asEN constructor",this.shouldRun()),this.shouldRun()&&("loading"!==document.readyState?this.init():document.addEventListener("DOMContentLoaded",(()=>{this.init()})))}init(){this.loadOptions(),this.createFields(),this.addEventListeners()}shouldRun(){return!(!document.querySelector("form.en__component")||!window.hasOwnProperty("pageJson"))}loadOptions(){const e=document.querySelector("script[src*='as-en.js']");this.fields.address1=e.getAttribute("data-address1")||this.fields.address1,this.fields.address2=e.getAttribute("data-address2")||this.fields.address2,this.fields.city=e.getAttribute("data-city")||this.fields.city,this.fields.region=e.getAttribute("data-region")||this.fields.region,this.fields.postalCode=e.getAttribute("data-postalCode")||this.fields.postalCode,this.fields.country=e.getAttribute("data-country")||this.fields.country,this.as_record=e.getAttribute("data-as_record")||this.as_record,this.as_date=e.getAttribute("data-as_date")||this.as_date,this.as_status=e.getAttribute("data-as_status")||this.as_status,this.cid=e.getAttribute("data-cid")||this.cid}getField(e){return document.querySelector('[name="'.concat(e,'"]'))}getFieldValue(e){return new FormData(document.querySelector("form.en__component")).getAll(e).join(",")}addEventListeners(){for(const e in this.fields){const t=this.getField(this.fields[e]);t&&t.addEventListener("change",(()=>{this.isDebug()&&console.log("asEN changed "+t.name,!0),this.isDirty=!0}))}window.enOnSubmit=()=>!(this.isDirty&&!this.wasCalled)||(this.isDebug()&&console.log("asEN Calling Adress API"),this.callAPI())}callAPI(){const e={address1:this.getFieldValue(this.fields.address1),address2:this.getFieldValue(this.fields.address2),city:this.getFieldValue(this.fields.city),region:this.getFieldValue(this.fields.region),postalCode:this.getFieldValue(this.fields.postalCode),country:this.getFieldValue(this.fields.country),cid:this.cid};return this.wasCalled=!0,this.isDebug()&&console.log("asEN formData",e),fetch(this.endpoint,{headers:{"Content-Type":"application/json; charset=utf-8"},method:"POST",body:JSON.stringify(e)}).then((e=>e.json())).then((async t=>{this.isDebug()&&console.log("asEN callAPI response",t);const s=this.getField(this.as_record),i=this.getField(this.as_date),n=this.getField(this.as_status);if("changed"in t&&!0===t.valid){let r=this.setFields(t.changed);r.formData=e,await this.checkSum(JSON.stringify(r)).then((e=>{this.isDebug()&&console.log("asEN checksum",e),r.requestId=t.requestId,r.checksum=e})),s&&(s.value=JSON.stringify(r)),i&&(i.value=this.todaysDate()),n&&(n.value="Success")}else if("error"in t){let r=new Object;r.formData=e,await this.checkSum(JSON.stringify(r)).then((e=>{this.isDebug()&&console.log("asEN checksum",e),r.requestId=t.requestId,r.checksum=e})),s&&(s.value=JSON.stringify(r)),i&&(i.value=this.todaysDate()),n&&(n.value=t.error)}})).catch((e=>{console.error("Address Standardization Error",e)}))}setFields(e){let t={};const s=this.getFieldValue(this.fields.country),i=this.getFieldValue(this.fields.postalCode),n=this.getField(this.fields.address2);"address2"in e&&!n&&(this.getFieldValue(this.fields.address1)==e.address1+" "+e.address2?(delete e.address1,delete e.address2):(e.address1=e.address1+" "+e.address2,delete e.address2)),"postalCode"in e&&i.match(/\d+/g).join("")===e.postalCode.match(/\d+/g).join("")&&delete e.postalCode;for(const i in e){const n=this.getField(this.fields[i]);if(n){let r=e[i];"postalCode"===i&&["US","USA","United States"].includes(s)&&(r=r.match(/\d+/g).join("")),t[i]={from:n.value,to:r},n.value=r}}return t}async checkSum(e){const t=new TextEncoder("utf-8").encode(e),s=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(s)).map((e=>("00"+e.toString(16)).slice(-2))).join("")}isDebug(){var e=new RegExp("[\\?&]debug=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}createHiddenInput(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=document.querySelector("form.en__component"),i=document.createElement("input");return i.type="hidden",i.name=e,i.classList.add("en__field__input"),i.classList.add("en__field__input--text"),i.classList.add("engrid-added-input"),i.setAttribute("autocomplete","off"),i.value=t,s.appendChild(i),i}createFields(){this.as_record&&(this.getField(this.as_record)||(this.createHiddenInput(this.as_record,""),this.isDebug()&&console.log("asEN creating hidden field: "+this.as_record))),this.as_date&&(this.getField(this.as_date)||(this.createHiddenInput(this.as_date,""),this.isDebug()&&console.log("asEN creating hidden field: "+this.as_date))),this.as_status&&(this.getField(this.as_status)||(this.createHiddenInput(this.as_status,""),this.isDebug()&&console.log("asEN creating hidden field: "+this.as_status)))}todaysDate(){return(new Date).toLocaleString("en-ZA",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\/+/g,"")}}}()}();