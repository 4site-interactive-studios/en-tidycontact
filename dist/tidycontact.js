!function(){"use strict";var t={705:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",s=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),s&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),s&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,s,r,n){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(s)for(var d=0;d<this.length;d++){var a=this[d][0];null!=a&&(o[a]=!0)}for(var l=0;l<t.length;l++){var c=[].concat(t[l]);s&&o[c[0]]||(void 0!==n&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=n),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},738:function(t){t.exports=function(t){return t[1]}},745:function(t,e,i){var s=i(738),r=i.n(s),n=i(705),o=i.n(n)()(r());o.push([t.id,"",""]),e.Z=o},379:function(t){var e=[];function i(t){for(var i=-1,s=0;s<e.length;s++)if(e[s].identifier===t){i=s;break}return i}function s(t,s){for(var n={},o=[],d=0;d<t.length;d++){var a=t[d],l=s.base?a[0]+s.base:a[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var h=i(u),f={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==h)e[h].references++,e[h].updater(f);else{var g=r(f,s);s.byIndex=d,e.splice(d,0,{identifier:u,updater:g,references:1})}o.push(u)}return o}function r(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,r){var n=s(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<n.length;o++){var d=i(n[o]);e[d].references--}for(var a=s(t,r),l=0;l<n.length;l++){var c=i(n[l]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}n=a}}},569:function(t){var e={};t.exports=function(t,i){var s=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},216:function(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:function(t,e,i){t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},795:function(t){t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var r=void 0!==i.layer;r&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,r&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var n=i.sourceMap;n&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:function(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function i(s){var r=e[s];if(void 0!==r)return r.exports;var n=e[s]={id:s,exports:{}};return t[s](n,n.exports,i),n.exports}i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var e=i(379),s=i.n(e),r=i(795),n=i.n(r),o=i(569),d=i.n(o),a=i(565),l=i.n(a),c=i(216),u=i.n(c),h=i(589),f=i.n(h),g=i(745),p={};p.styleTagTransform=f(),p.setAttributes=l(),p.insert=d().bind(null,"head"),p.domAPI=n(),p.insertStyleElement=u(),s()(g.Z,p),g.Z&&g.Z.locals&&g.Z.locals,new class{constructor(){t(this,"endpoint","https://api.tidycontact.io"),t(this,"wasCalled",!1),t(this,"httpStatus",null),t(this,"timeout",3),t(this,"isDirty",!1),t(this,"cid",0),t(this,"record_field",""),t(this,"date_field",""),t(this,"status_field",""),t(this,"countries",["us"]),t(this,"country_fallback","us"),t(this,"us_zip_divider","-"),t(this,"fields",{address1:"supporter.address1",address2:"supporter.address2",address3:"supporter.address3",city:"supporter.city",region:"supporter.region",postalCode:"supporter.postcode",country:"supporter.country"}),this.loadOptions(),this.shouldRun()&&("loading"!==document.readyState?this.init():document.addEventListener("DOMContentLoaded",(()=>{this.init()})))}init(){for(;!this.checkNested(EngagingNetworks,"require","_defined","enjs","checkSubmissionFailed");)return this.isDebug()&&console.log("TidyContact waiting for EngagingNetworks"),void window.setTimeout((()=>{this.init()}),10);this.createFields(),this.addEventListeners(),EngagingNetworks.require._defined.enjs.checkSubmissionFailed()||""==this.getFieldValue(this.fields.address1)||(this.isDebug()&&console.log("TidyContact Address Field is not empty"),this.isDirty=!0)}shouldRun(){return!!(document.querySelector("form.en__component")&&window.hasOwnProperty("pageJson")&&this.hasAddressFields())||(this.isDebug()&&console.log("TidyContact - No EN Address Fields Found"),!1)}loadOptions(){this.fields.address1=this.getScriptData("address1",this.fields.address1),this.fields.address2=this.getScriptData("address2",this.fields.address2),this.fields.city=this.getScriptData("city",this.fields.city),this.fields.region=this.getScriptData("region",this.fields.region),this.fields.postalCode=this.getScriptData("postalCode",this.fields.postalCode),this.fields.country=this.getScriptData("country",this.fields.country),this.record_field=this.getScriptData("record_field",this.record_field),this.date_field=this.getScriptData("date_field",this.date_field),this.status_field=this.getScriptData("status_field",this.status_field),this.us_zip_divider=this.getScriptData("us_zip_divider",this.us_zip_divider),this.cid=this.getScriptData("cid",this.cid),this.country_fallback=this.getScriptData("country_fallback",this.country_fallback);const t=this.getScriptData("country-allow",this.country_allow);t&&(this.countries=t.split(",").map((t=>t.trim().toLowerCase()))),this.isDebug()&&console.log("Countries Allowed",this.countries)}getField(t){return document.querySelector('[name="'.concat(t,'"]'))}getFieldValue(t){return new FormData(document.querySelector("form.en__component")).getAll(t).join(",")}addEventListeners(){for(const t in this.fields){const e=this.getField(this.fields[t]);e&&e.addEventListener("change",(()=>{this.isDebug()&&console.log("TidyContact changed "+e.name,!0),this.isDirty=!0}))}window.enOnSubmit=()=>!(this.isDirty&&!this.wasCalled)||(this.isDebug()&&console.log("TidyContact Calling Adress API"),this.callAPI())}hasAddressFields(){const t=this.getField(this.fields.address1),e=this.getField(this.fields.address2),i=this.getField(this.fields.city),s=this.getField(this.fields.region),r=this.getField(this.fields.postalCode),n=this.getField(this.fields.country);return!!(t||e||i||s||r||n)}canUseAPI(){const t=!!this.getCountry(),e=!!this.getFieldValue(this.fields.address1),i=!!this.getFieldValue(this.fields.city),s=!!this.getFieldValue(this.fields.region),r=!!this.getFieldValue(this.fields.postalCode);return!(!t||!e)&&(i&&s||r)}getCountry(){var t;const e=null!==(t=this.country_fallback)&&void 0!==t?t:"";return this.getFieldValue(this.fields.country)||e.toUpperCase()}callAPI(){const t=this.getFieldValue(this.fields.address1),e=this.getFieldValue(this.fields.address2),i=this.getFieldValue(this.fields.city),s=this.getFieldValue(this.fields.region),r=this.getFieldValue(this.fields.postalCode),n=this.getCountry(),o=this.getField("supporter.geo.latitude"),d=this.getField("supporter.geo.longitude"),a=this.getField(this.record_field),l=this.getField(this.date_field),c=this.getField(this.status_field);if(!this.canUseAPI())return this.isDebug()&&console.log("Not Enough Data to Call API"),l&&(l.value=this.todaysDate()),c&&(c.value="PARTIALADDRESS"),!0;if(!this.countryAllowed(n)){if(a){let t={};t=Object.assign({date:this.todaysDate(),status:"DISALLOWED"},t),a.value=JSON.stringify(t)}return l&&(l.value=this.todaysDate()),c&&(c.value="DISALLOWED"),!0}const u={address1:t,address2:e,city:i,region:s,postalCode:r,country:n,url:window.location.href,cid:this.cid};return this.wasCalled=!0,this.isDebug()&&console.log("TidyContact formData",JSON.parse(JSON.stringify(u))),this.fetchTimeout(this.endpoint,this.timeout,{headers:{"Content-Type":"application/json; charset=utf-8"},method:"POST",body:JSON.stringify(u)}).then((t=>(this.httpStatus=t.status,t.json()))).then((async t=>{if(this.isDebug()&&console.log("TidyContact callAPI response",JSON.parse(JSON.stringify(t))),!0===t.valid){let e=new Object;"changed"in t&&(e=this.setFields(t.changed)),e.formData=u,await this.checkSum(JSON.stringify(e)).then((i=>{this.isDebug()&&console.log("TidyContact checksum",i),e.requestId=t.requestId,e.checksum=i})),"latitude"in t&&(o.value=t.latitude,e.latitude=t.latitude),"longitude"in t&&(d.value=t.longitude,e.longitude=t.longitude),a&&(e=Object.assign({date:this.todaysDate(),status:"SUCCESS"},e),a.value=JSON.stringify(e)),l&&(l.value=this.todaysDate()),c&&(c.value="SUCCESS")}else{let e=new Object;e.formData=u,await this.checkSum(JSON.stringify(e)).then((i=>{this.isDebug()&&console.log("TidyContact checksum",i),e.requestId=t.requestId,e.checksum=i})),a&&(e=Object.assign({date:this.todaysDate(),status:"ERROR"},e),a.value=JSON.stringify(e)),l&&(l.value=this.todaysDate()),c&&(c.value="error"in t?"ERROR: "+t.error:"INVALIDADDRESS")}})).catch((t=>{t.toString().includes("AbortError")&&(this.isDebug()&&console.log("TidyContact fetch aborted"),this.httpStatus=408),this.writeError(t)}))}setFields(t){let e={};const i=this.getCountry(),s=this.getFieldValue(this.fields.postalCode),r=this.getField(this.fields.address2);"address2"in t&&!r&&(this.getFieldValue(this.fields.address1)==t.address1+" "+t.address2?(delete t.address1,delete t.address2):(t.address1=t.address1+" "+t.address2,delete t.address2)),"postalCode"in t&&s.replace("+",this.us_zip_divider)===t.postalCode.replace("+",this.us_zip_divider)&&delete t.postalCode;for(const s in t){const r=this.getField(this.fields[s]);if(r){let n=t[s];"postalCode"===s&&["US","USA","United States"].includes(i)&&(n=n.replace("+",this.us_zip_divider)),e[s]={from:r.value,to:n},r.value=n}}return e}async checkSum(t){const e=new TextEncoder("utf-8").encode(t),i=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(i)).map((t=>("00"+t.toString(16)).slice(-2))).join("")}isDebug(){var t=new RegExp("[\\?&]debug=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}createHiddenInput(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=document.querySelector("form.en__component"),s=document.createElement("input");return s.type="hidden",s.name=t,s.classList.add("en__field__input"),s.classList.add("en__field__input--text"),s.classList.add("tidycontact-added-input"),s.setAttribute("autocomplete","off"),s.value=e,i.appendChild(s),s}createFields(){const t=this.getField("supporter.geo.latitude"),e=this.getField("supporter.geo.longitude");t||(this.createHiddenInput("supporter.geo.latitude",""),this.isDebug()&&console.log("Creating Hidden Field: supporter.geo.latitude")),e||(this.createHiddenInput("supporter.geo.longitude",""),this.isDebug()&&console.log("Creating Hidden Field: supporter.geo.longitude")),this.record_field&&(this.getField(this.record_field)||(this.createHiddenInput(this.record_field,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.record_field))),this.date_field&&(this.getField(this.date_field)||(this.createHiddenInput(this.date_field,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.date_field))),this.status_field&&(this.getField(this.status_field)||(this.createHiddenInput(this.status_field,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.status_field))),this.getField(this.fields.address2)||(this.createHiddenInput(this.fields.address2,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.fields.address2)),this.getField(this.fields.address3)||(this.createHiddenInput(this.fields.address3,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.fields.address3))}todaysDate(){return(new Date).toLocaleString("en-ZA",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\/+/g,"")}checkNested(t,e){if(void 0===t)return!1;for(var i=arguments.length,s=new Array(i>2?i-2:0),r=2;r<i;r++)s[r-2]=arguments[r];return!(0!=s.length||!t.hasOwnProperty(e))||this.checkNested(t[e],...s)}countryAllowed(t){return!(this.countries.length>0)||this.countries.includes(t.toLowerCase())}getScriptData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=document.querySelector("script[src*='cdn.tidycontact.io/engagingnetworks.js'], script[src*='tidycontact.js'], script[data-tidycontact]");if(i){const s=i.getAttribute("data-"+t);return null!=s?s:e}return this.isDebug()&&console.error("TidyContact Script Not Found"),e}fetchTimeout(t,e){let{signal:i,...s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new AbortController,n=fetch(t,{signal:r.signal,...s});i&&i.addEventListener("abort",(()=>r.abort()));const o=setTimeout((()=>r.abort()),1e3*e);return n.finally((()=>clearTimeout(o)))}writeError(t){const e=this.getField(this.record_field),i=this.getField(this.date_field),s=this.getField(this.status_field);if(e){let i="";switch(this.httpStatus){case 400:i="Bad Request";break;case 401:i="Unauthorized";break;case 403:i="Forbidden";break;case 404:i="Not Found";break;case 408:i="API Request Timeout";break;case 500:i="Internal Server Error";break;case 503:i="Service Unavailable";break;default:i="Unknown Error"}const s={status:this.httpStatus,error:"string"==typeof t?t:i.toUpperCase()};e.value=JSON.stringify(s)}i&&(i.value=this.todaysDate()),s&&(s.value="ERROR-API")}}}()}();