!function(){"use strict";var t={705:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var s="",i=void 0!==e[5];return e[4]&&(s+="@supports (".concat(e[4],") {")),e[2]&&(s+="@media ".concat(e[2]," {")),i&&(s+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),s+=t(e),i&&(s+="}"),e[2]&&(s+="}"),e[4]&&(s+="}"),s})).join("")},e.i=function(t,s,i,n,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var d=this[a][0];null!=d&&(o[d]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);i&&o[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=r),s&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=s):l[2]=s),n&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=n):l[4]="".concat(n)),e.push(l))}},e}},738:function(t){t.exports=function(t){return t[1]}},745:function(t,e,s){var i=s(738),n=s.n(i),r=s(705),o=s.n(r)()(n());o.push([t.id,"",""]),e.Z=o},379:function(t){var e=[];function s(t){for(var s=-1,i=0;i<e.length;i++)if(e[i].identifier===t){s=i;break}return s}function i(t,i){for(var r={},o=[],a=0;a<t.length;a++){var d=t[a],c=i.base?d[0]+i.base:d[0],l=r[c]||0,u="".concat(c," ").concat(l);r[c]=l+1;var h=s(u),g={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==h)e[h].references++,e[h].updater(g);else{var p=n(g,i);i.byIndex=a,e.splice(a,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function n(t,e){var s=e.domAPI(e);return s.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;s.update(t=e)}else s.remove()}}t.exports=function(t,n){var r=i(t=t||[],n=n||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=s(r[o]);e[a].references--}for(var d=i(t,n),c=0;c<r.length;c++){var l=s(r[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}r=d}}},569:function(t){var e={};t.exports=function(t,s){var i=function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(t){s=null}e[t]=s}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},216:function(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:function(t,e,s){t.exports=function(t){var e=s.nc;e&&t.setAttribute("nonce",e)}},795:function(t){t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(s){!function(t,e,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,n&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,s)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:function(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var r=e[i]={id:i,exports:{}};return t[i](r,r.exports,s),r.exports}s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,{a:e}),e},s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){function t(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var e=s(379),i=s.n(e),n=s(795),r=s.n(n),o=s(569),a=s.n(o),d=s(565),c=s.n(d),l=s(216),u=s.n(l),h=s(589),g=s.n(h),p=s(745),f={};f.styleTagTransform=g(),f.setAttributes=c(),f.insert=a().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=u(),i()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals,new class{constructor(){t(this,"endpoint","https://api.tidycontact.io"),t(this,"wasCalled",!1),t(this,"httpStatus",null),t(this,"timeout",5),t(this,"isDirty",!1),t(this,"cid",0),t(this,"as_record",""),t(this,"as_date",""),t(this,"as_status",""),t(this,"countries",[]),t(this,"fields",{address1:"supporter.address1",address2:"supporter.address2",address3:"supporter.address3",city:"supporter.city",region:"supporter.region",postalCode:"supporter.postcode",country:"supporter.country"}),this.isDebug()&&console.log("TidyContact constructor",this.shouldRun()),this.shouldRun()&&("loading"!==document.readyState?this.init():document.addEventListener("DOMContentLoaded",(()=>{this.init()})))}init(){for(;!this.checkNested(EngagingNetworks,"require","_defined","enjs","checkSubmissionFailed");)return this.isDebug()&&console.log("TidyContact waiting for EngagingNetworks"),void window.setTimeout((()=>{this.init()}),10);this.loadOptions(),this.createFields(),this.addEventListeners(),EngagingNetworks.require._defined.enjs.checkSubmissionFailed()||""==this.getFieldValue(this.fields.address1)||(this.isDebug()&&console.log("TidyContact Address Field is not empty"),this.isDirty=!0)}shouldRun(){return!(!document.querySelector("form.en__component")||!window.hasOwnProperty("pageJson"))}loadOptions(){this.fields.address1=this.getScriptData("address1",this.fields.address1),this.fields.address2=this.getScriptData("address2",this.fields.address2),this.fields.city=this.getScriptData("city",this.fields.city),this.fields.region=this.getScriptData("region",this.fields.region),this.fields.postalCode=this.getScriptData("postalCode",this.fields.postalCode),this.fields.country=this.getScriptData("country",this.fields.country),this.as_record=this.getScriptData("as_record",this.as_record),this.as_date=this.getScriptData("as_date",this.as_date),this.as_status=this.getScriptData("as_status",this.as_status),this.cid=this.getScriptData("cid",this.cid);const t=this.getScriptData("country-allow",this.country_allow);t&&(this.countries=t.split(",").map((t=>t.trim().toLowerCase()))),this.isDebug()&&console.log("Countries Allowed",this.countries)}getField(t){return document.querySelector('[name="'.concat(t,'"]'))}getFieldValue(t){return new FormData(document.querySelector("form.en__component")).getAll(t).join(",")}addEventListeners(){for(const t in this.fields){const e=this.getField(this.fields[t]);e&&e.addEventListener("change",(()=>{this.isDebug()&&console.log("TidyContact changed "+e.name,!0),this.isDirty=!0}))}window.enOnSubmit=()=>!(this.isDirty&&!this.wasCalled)||(this.isDebug()&&console.log("TidyContact Calling Adress API"),this.callAPI())}callAPI(){const t=this.getFieldValue(this.fields.address1),e=this.getFieldValue(this.fields.address2),s=this.getFieldValue(this.fields.city),i=this.getFieldValue(this.fields.region),n=this.getFieldValue(this.fields.postalCode),r=this.getFieldValue(this.fields.country),o=this.getField("supporter.geo.latitude"),a=this.getField("supporter.geo.longitude"),d=this.getField(this.as_record),c=this.getField(this.as_date),l=this.getField(this.as_status);if(!this.countryAllowed(r))return d&&(d.value="DISALLOWED"),c&&(c.value=this.todaysDate()),l&&(l.value="DISALLOWED"),!0;const u={address1:t,address2:e,city:s,region:i,postalCode:n,country:r,url:window.location.href,cid:this.cid};return this.wasCalled=!0,this.isDebug()&&console.log("TidyContact formData",JSON.parse(JSON.stringify(u))),this.fetchTimeout(this.endpoint,this.timeout,{headers:{"Content-Type":"application/json; charset=utf-8"},method:"POST",body:JSON.stringify(u)}).then((t=>(this.httpStatus=t.status,t.json()))).then((async t=>{if(this.isDebug()&&console.log("TidyContact callAPI response",JSON.parse(JSON.stringify(t))),!0===t.valid){let e=new Object;"changed"in t&&(e=this.setFields(t.changed)),e.formData=u,await this.checkSum(JSON.stringify(e)).then((s=>{this.isDebug()&&console.log("TidyContact checksum",s),e.requestId=t.requestId,e.checksum=s})),"latitude"in t&&(o.value=t.latitude,e.latitude=t.latitude),"longitude"in t&&(a.value=t.longitude,e.longitude=t.longitude),d&&(d.value=JSON.stringify(e)),c&&(c.value=this.todaysDate()),l&&(l.value="Success")}else{let e=new Object;e.formData=u,await this.checkSum(JSON.stringify(e)).then((s=>{this.isDebug()&&console.log("TidyContact checksum",s),e.requestId=t.requestId,e.checksum=s})),d&&(d.value=JSON.stringify(e)),c&&(c.value=this.todaysDate()),l&&(l.value="error"in t?"Error: "+t.error:"Invalid Address")}})).catch((t=>{t.toString().includes("AbortError")&&(this.isDebug()&&console.log("TidyContact fetch aborted"),this.httpStatus=408),this.writeError(t)}))}setFields(t){let e={};const s=this.getFieldValue(this.fields.country),i=this.getFieldValue(this.fields.postalCode),n=this.getField(this.fields.address2);"address2"in t&&!n&&(this.getFieldValue(this.fields.address1)==t.address1+" "+t.address2?(delete t.address1,delete t.address2):(t.address1=t.address1+" "+t.address2,delete t.address2)),"postalCode"in t&&i.match(/\d+/g).join("")===t.postalCode.match(/\d+/g).join("")&&delete t.postalCode;for(const i in t){const n=this.getField(this.fields[i]);if(n){let r=t[i];"postalCode"===i&&["US","USA","United States"].includes(s)&&(r=r.match(/\d+/g).join("")),e[i]={from:n.value,to:r},n.value=r}}return e}async checkSum(t){const e=new TextEncoder("utf-8").encode(t),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map((t=>("00"+t.toString(16)).slice(-2))).join("")}isDebug(){var t=new RegExp("[\\?&]debug=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}createHiddenInput(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=document.querySelector("form.en__component"),i=document.createElement("input");return i.type="hidden",i.name=t,i.classList.add("en__field__input"),i.classList.add("en__field__input--text"),i.classList.add("engrid-added-input"),i.setAttribute("autocomplete","off"),i.value=e,s.appendChild(i),i}createFields(){const t=this.getField("supporter.geo.latitude"),e=this.getField("supporter.geo.longitude");t||(this.createHiddenInput("supporter.geo.latitude",""),this.isDebug()&&console.log("Creating Hidden Field: supporter.geo.latitude")),e||(this.createHiddenInput("supporter.geo.longitude",""),this.isDebug()&&console.log("Creating Hidden Field: supporter.geo.longitude")),this.as_record&&(this.getField(this.as_record)||(this.createHiddenInput(this.as_record,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.as_record))),this.as_date&&(this.getField(this.as_date)||(this.createHiddenInput(this.as_date,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.as_date))),this.as_status&&(this.getField(this.as_status)||(this.createHiddenInput(this.as_status,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.as_status))),this.getField(this.fields.address2)||(this.createHiddenInput(this.fields.address2,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.fields.address2)),this.getField(this.fields.address3)||(this.createHiddenInput(this.fields.address3,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.fields.address3))}todaysDate(){return(new Date).toLocaleString("en-ZA",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\/+/g,"")}checkNested(t,e){if(void 0===t)return!1;for(var s=arguments.length,i=new Array(s>2?s-2:0),n=2;n<s;n++)i[n-2]=arguments[n];return!(0!=i.length||!t.hasOwnProperty(e))||this.checkNested(t[e],...i)}countryAllowed(t){return!(this.countries.length>0)||this.countries.includes(t.toLowerCase())}getScriptData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=document.querySelector("script[src*='cdn.tidycontact.io/engagingnetworks.js']");if(s){const i=s.getAttribute("data-"+t);return null!=i?i:e}return this.isDebug()&&console.error("TidyContact Script Not Found"),e}fetchTimeout(t,e){let{signal:s,...i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=new AbortController,r=fetch(t,{signal:n.signal,...i});s&&s.addEventListener("abort",(()=>n.abort()));const o=setTimeout((()=>n.abort()),1e3*e);return r.finally((()=>clearTimeout(o)))}writeError(t){const e=this.getField(this.as_record),s=this.getField(this.as_date),i=this.getField(this.as_status);if(e){let s="";switch(this.httpStatus){case 400:s="Bad Request";break;case 401:s="Unauthorized";break;case 403:s="Forbidden";break;case 404:s="Not Found";break;case 408:s="API Request Timeout";break;case 500:s="Internal Server Error";break;case 503:s="Service Unavailable";break;default:s="Unknown Error"}const i={status:this.httpStatus,error:"string"==typeof t?t:s};e.value=JSON.stringify(i)}s&&(s.value=this.todaysDate()),i&&(i.value="API Error")}}}()}();