!function(){"use strict";var t={705:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",s=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),s&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),s&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,s,n,a){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(s)for(var r=0;r<this.length;r++){var d=this[r][0];null!=d&&(o[d]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);s&&o[l[0]]||(void 0!==a&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=a),i&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=i):l[2]=i),n&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=n):l[4]="".concat(n)),e.push(l))}},e}},738:function(t){t.exports=function(t){return t[1]}},745:function(t,e,i){var s=i(738),n=i.n(s),a=i(705),o=i.n(a)()(n());o.push([t.id,'.tc-has-country-flags{position:relative}.tc-has-country-flags input{padding-left:52px}.tc-hide{display:none}.tc-flags-container{position:absolute;top:0;bottom:0;left:0;padding:1px;cursor:pointer;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.tc-flags-container *{box-sizing:border-box}.tc-flags-container:hover .tc-selected-flag{background-color:rgba(0,0,0,.05)}.tc-selected-flag{z-index:1;position:relative;display:flex;align-items:center;height:100%;padding:0 6px 0 8px}.tc-selected-flag .tc-flag{width:25px;line-height:0}.tc-selected-flag .tc-flag img{max-width:100%;-o-object-fit:contain;object-fit:contain}.tc-selected-flag .tc-flag-arrow{margin-left:5px;width:0;height:0;border-left:3px solid transparent;border-right:3px solid transparent;border-top:4px solid #555}.tc-selected-flag.tc-open .tc-flag-arrow{transform:rotate(180deg)}.tc-country-list{position:absolute;z-index:2;list-style:none;text-align:left;padding:0;margin:0 0 0 -1px;box-shadow:1px 1px 4px rgba(0,0,0,.2);background-color:#fff;border:1px solid #ccc;white-space:nowrap;max-height:205px;overflow-y:scroll;scroll-snap-type:y mandatory;-webkit-overflow-scrolling:touch}.tc-country-list .tc-country{padding:5px 10px;outline:none;display:flex;align-items:stretch;scroll-snap-align:start}.tc-country-list .tc-country:hover,.tc-country-list .tc-country.tc-highlight{background-color:rgba(0,0,0,.05)}.tc-country-list .tc-country .tc-flag-box{width:20px;margin-right:6px;display:flex;align-items:center}.tc-country-list .tc-country .tc-flag-box img{max-width:100%;-o-object-fit:contain;object-fit:contain}.tc-country-list .tc-country .tc-country-name{margin-right:6px}.tc-country-list .tc-country .tc-dial-code{color:#999}.tc-country-list .tc-divider{padding-bottom:5px;margin-bottom:5px;border-bottom:1px solid #ccc}',""]),e.Z=o},379:function(t){var e=[];function i(t){for(var i=-1,s=0;s<e.length;s++)if(e[s].identifier===t){i=s;break}return i}function s(t,s){for(var a={},o=[],r=0;r<t.length;r++){var d=t[r],c=s.base?d[0]+s.base:d[0],l=a[c]||0,u="".concat(c," ").concat(l);a[c]=l+1;var h=i(u),p={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==h)e[h].references++,e[h].updater(p);else{var g=n(p,s);s.byIndex=r,e.splice(r,0,{identifier:u,updater:g,references:1})}o.push(u)}return o}function n(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,n){var a=s(t=t||[],n=n||{});return function(t){t=t||[];for(var o=0;o<a.length;o++){var r=i(a[o]);e[r].references--}for(var d=s(t,n),c=0;c<a.length;c++){var l=i(a[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}a=d}}},569:function(t){var e={};t.exports=function(t,i){var s=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},216:function(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:function(t,e,i){t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},795:function(t){t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,n&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var a=i.sourceMap;a&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:function(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var a=e[s]={id:s,exports:{}};return t[s](a,a.exports,i),a.exports}i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var e=i(379),s=i.n(e),n=i(795),a=i.n(n),o=i(569),r=i.n(o),d=i(565),c=i.n(d),l=i(216),u=i.n(l),h=i(589),p=i.n(h),g=i(745),f={};f.styleTagTransform=p(),f.setAttributes=c(),f.insert=r().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=u(),s()(g.Z,f),g.Z&&g.Z.locals&&g.Z.locals,new class{constructor(){t(this,"endpoint","https://phone.tidycontact.io"),t(this,"wasCalled",!1),t(this,"httpStatus",null),t(this,"timeout",5),t(this,"isDirty",!1),t(this,"cid",0),t(this,"as_record",""),t(this,"as_date",""),t(this,"as_status",""),t(this,"countries",[]),t(this,"country_fallback",""),t(this,"us_zip_divider","+"),t(this,"fields",{address1:"supporter.address1",address2:"supporter.address2",address3:"supporter.address3",city:"supporter.city",region:"supporter.region",postalCode:"supporter.postcode",country:"supporter.country",phone:"supporter.phoneNumber2"}),t(this,"phone_enable",!1),t(this,"ps_record",""),t(this,"ps_date",""),t(this,"ps_status",""),t(this,"phone_flags",!0),t(this,"phone_preferred_countries",[]),t(this,"countries_list",[["Afghanistan","af","93","070 123 4567"],["Albania","al","355","067 212 3456"],["Algeria","dz","213","0551 23 45 67"],["American Samoa","as","1","(684) 733-1234"],["Andorra","ad","376","312 345"],["Angola","ao","244","923 123 456"],["Anguilla","ai","1","(264) 235-1234"],["Antigua and Barbuda","ag","1","(268) 464-1234"],["Argentina","ar","54","011 15-2345-6789"],["Armenia","am","374","077 123456"],["Aruba","aw","297","560 1234"],["Australia","au","61","0412 345 678"],["Austria","at","43","0664 123456"],["Azerbaijan","az","994","040 123 45 67"],["Bahamas","bs","1","(242) 359-1234"],["Bahrain","bh","973","3600 1234"],["Bangladesh","bd","880","01812-345678"],["Barbados","bb","1","(246) 250-1234"],["Belarus","by","375","8 029 491-19-11"],["Belgium","be","32","0470 12 34 56"],["Belize","bz","501","622-1234"],["Benin","bj","229","90 01 12 34"],["Bermuda","bm","1","(441) 370-1234"],["Bhutan","bt","975","17 12 34 56"],["Bolivia","bo","591","71234567"],["Bosnia and Herzegovina","ba","387","061 123 456"],["Botswana","bw","267","71 123 456"],["Brazil","br","55","(11) 96123-4567"],["British Indian Ocean Territory","io","246","380 1234"],["British Virgin Islands","vg","1","(284) 300-1234"],["Brunei","bn","673","712 3456"],["Bulgaria","bg","359","048 123 456"],["Burkina Faso","bf","226","70 12 34 56"],["Burundi","bi","257","79 56 12 34"],["Cambodia","kh","855","091 234 567"],["Cameroon","cm","237","6 71 23 45 67"],["Canada","ca","1","(506) 234-5678"],["Cape Verde","cv","238","991 12 34"],["Caribbean Netherlands","bq","599","318 1234"],["Cayman Islands","ky","1","(345) 323-1234"],["Central African Republic","cf","236","70 01 23 45"],["Chad","td","235","63 01 23 45"],["Chile","cl","56","(2) 2123 4567"],["China","cn","86","131 2345 6789"],["Christmas Island","cx","61","0412 345 678"],["Cocos Islands","cc","61","0412 345 678"],["Colombia","co","57","321 1234567"],["Comoros","km","269","321 23 45"],["Congo","cd","243","0991 234 567"],["Congo","cg","242","06 123 4567"],["Cook Islands","ck","682","71 234"],["Costa Rica","cr","506","8312 3456"],["Côte d’Ivoire","ci","225","01 23 45 6789"],["Croatia","hr","385","092 123 4567"],["Cuba","cu","53","05 1234567"],["Curaçao","cw","599","9 518 1234"],["Cyprus","cy","357","96 123456"],["Czech Republic","cz","420","601 123 456"],["Denmark","dk","45","32 12 34 56"],["Djibouti","dj","253","77 83 10 01"],["Dominica","dm","1","(767) 225-1234"],["Dominican Republic","do","1","(809) 234-5678"],["Ecuador","ec","593","099 123 4567"],["Egypt","eg","20","0100 123 4567"],["El Salvador","sv","503","7012 3456"],["Equatorial Guinea","gq","240","222 123 456"],["Eritrea","er","291","07 123 456"],["Estonia","ee","372","5123 4567"],["Eswatini","sz","268","7612 3456"],["Ethiopia","et","251","091 123 4567"],["Falkland Islands","fk","500","51234"],["Faroe Islands","fo","298","211234"],["Fiji","fj","679","701 2345"],["Finland","fi","358","041 2345678"],["France","fr","33","06 12 34 56 78"],["French Guiana","gf","594","0694 20 12 34"],["French Polynesia","pf","689","87 12 34 56"],["Gabon","ga","241","06 03 12 34"],["Gambia","gm","220","301 2345"],["Georgia","ge","995","555 12 34 56"],["Germany","de","49","01512 3456789"],["Ghana","gh","233","023 123 4567"],["Gibraltar","gi","350","57123456"],["Greece","gr","30","691 234 5678"],["Greenland","gl","299","22 12 34"],["Grenada","gd","1","(473) 403-1234"],["Guadeloupe","gp","590","0690 00 12 34"],["Guam","gu","1","(671) 300-1234"],["Guatemala","gt","502","5123 4567"],["Guernsey","gg","44","07781 123456"],["Guinea","gn","224","601 12 34 56"],["Guinea-Bissau","gw","245","955 012 345"],["Guyana","gy","592","609 1234"],["Haiti","ht","509","34 10 1234"],["Honduras","hn","504","9123-4567"],["Hong Kong","hk","852","5123 4567"],["Hungary","hu","36","06 20 123 4567"],["Iceland","is","354","611 1234"],["India","in","91","081234 56789"],["Indonesia","id","62","0812-345-678"],["Iran","ir","98","0912 345 6789"],["Iraq","iq","964","0791 234 5678"],["Ireland","ie","353","085 012 3456"],["Isle of Man","im","44","07924 123456"],["Israel","il","972","050-234-5678"],["Italy","it","39","312 345 6789"],["Jamaica","jm","1","(876) 210-1234"],["Japan","jp","81","090-1234-5678"],["Jersey","je","44","07797 712345"],["Jordan","jo","962","07 9012 3456"],["Kazakhstan","kz","7","8 (771) 000 9998"],["Kenya","ke","254","0712 123456"],["Kiribati","ki","686","72001234"],["Kosovo","xk","383","043 201 234"],["Kuwait","kw","965","500 12345"],["Kyrgyzstan","kg","996","0700 123 456"],["Laos","la","856","020 23 123 456"],["Latvia","lv","371","21 234 567"],["Lebanon","lb","961","71 123 456"],["Lesotho","ls","266","5012 3456"],["Liberia","lr","231","077 012 3456"],["Libya","ly","218","091-2345678"],["Liechtenstein","li","423","660 234 567"],["Lithuania","lt","370","(8-612) 34567"],["Luxembourg","lu","352","628 123 456"],["Macau","mo","853","6612 3456"],["North Macedonia","mk","389","072 345 678"],["Madagascar","mg","261","032 12 345 67"],["Malawi","mw","265","0991 23 45 67"],["Malaysia","my","60","012-345 6789"],["Maldives","mv","960","771-2345"],["Mali","ml","223","65 01 23 45"],["Malta","mt","356","9696 1234"],["Marshall Islands","mh","692","235-1234"],["Martinique","mq","596","0696 20 12 34"],["Mauritania","mr","222","22 12 34 56"],["Mauritius","mu","230","5251 2345"],["Mayotte","yt","262","0639 01 23 45"],["Mexico","mx","52","222 123 4567"],["Micronesia","fm","691","350 1234"],["Moldova","md","373","0621 12 345"],["Monaco","mc","377","06 12 34 56 78"],["Mongolia","mn","976","8812 3456"],["Montenegro","me","382","067 622 901"],["Montserrat","ms","1","(664) 492-3456"],["Morocco","ma","212","0650-123456"],["Mozambique","mz","258","82 123 4567"],["Myanmar","mm","95","09 212 3456"],["Namibia","na","264","081 123 4567"],["Nauru","nr","674","555 1234"],["Nepal","np","977","984-1234567"],["Netherlands","nl","31","06 12345678"],["New Caledonia","nc","687","75.12.34"],["New Zealand","nz","64","021 123 4567"],["Nicaragua","ni","505","8123 4567"],["Niger","ne","227","93 12 34 56"],["Nigeria","ng","234","0802 123 4567"],["Niue","nu","683","888 4012"],["Norfolk Island","nf","672","3 81234"],["North Korea","kp","850","0192 123 4567"],["Northern Mariana Islands","mp","1","(670) 234-5678"],["Norway","no","47","406 12 345"],["Oman","om","968","9212 3456"],["Pakistan","pk","92","0301 2345678"],["Palau","pw","680","620 1234"],["Palestine","ps","970","0599 123 456"],["Panama","pa","507","6123-4567"],["Papua New Guinea","pg","675","7012 3456"],["Paraguay","py","595","0961 456789"],["Peru","pe","51","912 345 678"],["Philippines","ph","63","0905 123 4567"],["Poland","pl","48","512 345 678"],["Portugal","pt","351","912 345 678"],["Puerto Rico","pr","1","(787) 234-5678"],["Qatar","qa","974","3312 3456"],["Réunion","re","262","0692 12 34 56"],["Romania","ro","40","0712 034 567"],["Russia","ru","7","8 (912) 345-67-89"],["Rwanda","rw","250","0720 123 456"],["Saint Barthélemy","bl","590","0690 00 12 34"],["Saint Helena","sh","290","51234"],["Saint Kitts and Nevis","kn","1","(869) 765-2917"],["Saint Lucia","lc","1","(758) 284-5678"],["Saint Martin","mf","590","0690 00 12 34"],["Saint Pierre and Miquelon","pm","508","055 12 34"],["Saint Vincent and the Grenadines","vc","1","(784) 430-1234"],["Samoa","ws","685","72 12345"],["San Marino","sm","378","66 66 12 12"],["São Tomé and Príncipe","st","239","981 2345"],["Saudi Arabia","sa","966","051 234 5678"],["Senegal","sn","221","70 123 45 67"],["Serbia","rs","381","060 1234567"],["Seychelles","sc","248","2 510 123"],["Sierra Leone","sl","232","(025) 123456"],["Singapore","sg","65","8123 4567"],["Sint Maarten","sx","1","(721) 520-5678"],["Slovakia","sk","421","0912 123 456"],["Slovenia","si","386","031 234 567"],["Solomon Islands","sb","677","74 21234"],["Somalia","so","252","7 1123456"],["South Africa","za","27","071 123 4567"],["South Korea","kr","82","010-2000-0000"],["South Sudan","ss","211","0977 123 456"],["Spain","es","34","612 34 56 78"],["Sri Lanka","lk","94","071 234 5678"],["Sudan","sd","249","091 123 1234"],["Suriname","sr","597","741-2345"],["Svalbard and Jan Mayen","sj","47","412 34 567"],["Sweden","se","46","070-123 45 67"],["Switzerland","ch","41","078 123 45 67"],["Syria","sy","963","0944 567 890"],["Taiwan","tw","886","0912 345 678"],["Tajikistan","tj","992","917 12 3456"],["Tanzania","tz","255","0621 234 567"],["Thailand","th","66","081 234 5678"],["Timor-Leste","tl","670","7721 2345"],["Togo","tg","228","90 11 23 45"],["Tokelau","tk","690","7290"],["Tonga","to","676","771 5123"],["Trinidad and Tobago","tt","1","(868) 291-1234"],["Tunisia","tn","216","20 123 456"],["Turkey","tr","90","0501 234 56 78"],["Turkmenistan","tm","993","8 66 123456"],["Turks and Caicos Islands","tc","1","(649) 231-1234"],["Tuvalu","tv","688","90 1234"],["U.S. Virgin Islands","vi","1","(340) 642-1234"],["Uganda","ug","256","0712 345678"],["Ukraine","ua","380","050 123 4567"],["United Arab Emirates","ae","971","050 123 4567"],["United Kingdom","gb","44","07400 123456"],["United States","us","1","(201) 555-0123"],["Uruguay","uy","598","094 231 234"],["Uzbekistan","uz","998","8 91 234 56 78"],["Vanuatu","vu","678","591 2345"],["Vatican City","va","39","312 345 6789"],["Venezuela","ve","58","0412-1234567"],["Vietnam","vn","84","091 234 56 78"],["Wallis and Futuna","wf","681","82 12 34"],["Western Sahara","eh","212","0650-123456"],["Yemen","ye","967","0712 345 678"],["Zambia","zm","260","095 5123456"],["Zimbabwe","zw","263","071 234 5678"],["Åland Islands","ax","358","041 2345678"]]),t(this,"countries_dropdown",null),this.loadOptions(),this.shouldRun()&&("loading"!==document.readyState?this.init():document.addEventListener("DOMContentLoaded",(()=>{this.init()})))}init(){for(;!this.checkNested(EngagingNetworks,"require","_defined","enjs","checkSubmissionFailed");)return this.isDebug()&&console.log("TidyContact waiting for EngagingNetworks"),void window.setTimeout((()=>{this.init()}),10);if(this.createFields(),this.addEventListeners(),EngagingNetworks.require._defined.enjs.checkSubmissionFailed()||""==this.getFieldValue(this.fields.address1)||(this.isDebug()&&console.log("TidyContact Address Field is not empty"),this.isDirty=!0),this.phoneEnabled()){this.createPhoneFields(),this.isDebug()&&console.log("TidyContact Phone Standardization is enabled"),this.countryDropDownEnabled()&&this.renderFlagsDropDown();const t=this.getField(this.fields.phone);t&&(t.addEventListener("keyup",(t=>{this.handlePhoneInputKeydown(t)})),this.setDefaultPhoneCountry())}}shouldRun(){return!!(document.querySelector("form.en__component")&&window.hasOwnProperty("pageJson")&&this.hasAddressFields())||(this.isDebug()&&console.log("TidyContact - No EN Address Fields Found"),!1)}loadOptions(){this.fields.address1=this.getScriptData("address1",this.fields.address1),this.fields.address2=this.getScriptData("address2",this.fields.address2),this.fields.city=this.getScriptData("city",this.fields.city),this.fields.region=this.getScriptData("region",this.fields.region),this.fields.postalCode=this.getScriptData("postalCode",this.fields.postalCode),this.fields.country=this.getScriptData("country",this.fields.country),this.as_record=this.getScriptData("as_record",this.as_record),this.as_date=this.getScriptData("as_date",this.as_date),this.as_status=this.getScriptData("as_status",this.as_status),this.us_zip_divider=this.getScriptData("us_zip_divider",this.us_zip_divider),this.cid=this.getScriptData("cid",this.cid),this.country_fallback=this.getScriptData("country_fallback",this.country_fallback);const t=this.getScriptData("country-allow","");t&&(this.countries=t.split(",").map((t=>t.trim().toLowerCase()))),this.isDebug()&&console.log("Countries Allowed",this.countries),this.fields.phone=this.getScriptData("phone",this.fields.phone),this.ps_record=this.getScriptData("ps_record",this.ps_record),this.ps_date=this.getScriptData("ps_date",this.ps_date),this.ps_status=this.getScriptData("ps_status",this.ps_status),this.phone_enable=this.getScriptData("phone_enable",this.phone_enable),this.phone_flags=this.getScriptData("phone_flags",this.phone_flags);const e=this.getScriptData("phone_preferred_countries","");e&&(this.phone_preferred_countries=e.split(",").map((t=>t.trim().toLowerCase())))}getField(t){return document.querySelector('[name="'.concat(t,'"]'))}getFieldValue(t){return new FormData(document.querySelector("form.en__component")).getAll(t).join(",")}addEventListeners(){for(const t in this.fields){const e=this.getField(this.fields[t]);e&&e.addEventListener("change",(()=>{this.isDebug()&&console.log("TidyContact changed "+e.name,!0),this.isDirty=!0}))}window.enOnSubmit=()=>!(this.isDirty&&!this.wasCalled)||(this.isDebug()&&console.log("TidyContact Calling Adress API"),this.callAPI())}hasAddressFields(){const t=this.getField(this.fields.address1),e=this.getField(this.fields.address2),i=this.getField(this.fields.city),s=this.getField(this.fields.region),n=this.getField(this.fields.postalCode),a=this.getField(this.fields.country);return!!(t||e||i||s||n||a)}canUseAPI(){const t=!!this.getCountry(),e=!!this.getFieldValue(this.fields.address1),i=!!this.getFieldValue(this.fields.city),s=!!this.getFieldValue(this.fields.region),n=!!this.getFieldValue(this.fields.postalCode);if(t&&e)return i&&s||n}canUsePhoneAPI(){if(this.phoneEnabled()){const t=this.getFieldValue(this.fields.phone),e=this.getFieldValue("tc.phone.country");return t&&e}return!1}getCountry(){var t;const e=null!==(t=this.country_fallback)&&void 0!==t?t:"";return this.getFieldValue(this.fields.country)||e.toUpperCase()}callAPI(){const t=this.getFieldValue(this.fields.address1),e=this.getFieldValue(this.fields.address2),i=this.getFieldValue(this.fields.city),s=this.getFieldValue(this.fields.region),n=this.getFieldValue(this.fields.postalCode),a=this.getCountry(),o=this.getField("supporter.geo.latitude"),r=this.getField("supporter.geo.longitude"),d=this.getField(this.as_record),c=this.getField(this.as_date),l=this.getField(this.as_status);if(!this.canUseAPI()&&!this.canUsePhoneAPI())return this.isDebug()&&console.log("Not Enough Data to Call API"),c&&(c.value=this.todaysDate()),l&&(l.value="PARTIALADDRESS"),!0;if(!this.countryAllowed(a)){if(d){let t={};t=Object.assign({date:this.todaysDate(),status:"DISALLOWED"},t),d.value=JSON.stringify(t)}return c&&(c.value=this.todaysDate()),l&&(l.value="DISALLOWED"),!0}const u={address1:t,address2:e,city:i,region:s,postalCode:n,country:a,url:window.location.href,cid:this.cid};return this.phoneEnabled()&&(u.phone=this.getFieldValue(this.fields.phone),u.phoneCountry=this.getFieldValue("tc.phone.country")),this.wasCalled=!0,this.isDebug()&&console.log("TidyContact formData",JSON.parse(JSON.stringify(u))),this.fetchTimeout(this.endpoint,this.timeout,{headers:{"Content-Type":"application/json; charset=utf-8"},method:"POST",body:JSON.stringify(u)}).then((t=>(this.httpStatus=t.status,t.json()))).then((async t=>{if(this.isDebug()&&console.log("TidyContact callAPI response",JSON.parse(JSON.stringify(t))),!0===t.valid){let e=new Object;"changed"in t&&(e=this.setFields(t.changed)),e.formData=u,await this.checkSum(JSON.stringify(e)).then((i=>{this.isDebug()&&console.log("TidyContact checksum",i),e.requestId=t.requestId,e.checksum=i})),"latitude"in t&&(o.value=t.latitude,e.latitude=t.latitude),"longitude"in t&&(r.value=t.longitude,e.longitude=t.longitude),d&&(e=Object.assign({date:this.todaysDate(),status:"SUCCESS"},e),d.value=JSON.stringify(e)),c&&(c.value=this.todaysDate()),l&&(l.value="SUCCESS")}else{let e=new Object;e.formData=u,await this.checkSum(JSON.stringify(e)).then((i=>{this.isDebug()&&console.log("TidyContact checksum",i),e.requestId=t.requestId,e.checksum=i})),d&&(e=Object.assign({date:this.todaysDate(),status:"ERROR"},e),d.value=JSON.stringify(e)),c&&(c.value=this.todaysDate()),l&&(l.value="error"in t?"ERROR: "+t.error:"INVALIDADDRESS")}this.phoneEnabled()&&"phone"in t&&await this.setPhoneDataFromAPI(t.phone,t.requestId)})).catch((t=>{t.toString().includes("AbortError")&&(this.isDebug()&&console.log("TidyContact fetch aborted"),this.httpStatus=408),this.writeError(t)}))}setFields(t){let e={};const i=this.getCountry(),s=this.getFieldValue(this.fields.postalCode),n=this.getField(this.fields.address2);"address2"in t&&!n&&(this.getFieldValue(this.fields.address1)==t.address1+" "+t.address2?(delete t.address1,delete t.address2):(t.address1=t.address1+" "+t.address2,delete t.address2)),"postalCode"in t&&s.replace("+",this.us_zip_divider)===t.postalCode.replace("+",this.us_zip_divider)&&delete t.postalCode;for(const s in t){const n=this.getField(this.fields[s]);if(n){let a=t[s];"postalCode"===s&&["US","USA","United States"].includes(i)&&(a=a.replace("+",this.us_zip_divider)),e[s]={from:n.value,to:a},n.value=a}}return e}async checkSum(t){const e=new TextEncoder("utf-8").encode(t),i=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(i)).map((t=>("00"+t.toString(16)).slice(-2))).join("")}isDebug(){var t=new RegExp("[\\?&]debug=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}createHiddenInput(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=document.querySelector("form.en__component"),s=document.createElement("input");return s.type="hidden",s.name=t,s.classList.add("en__field__input"),s.classList.add("en__field__input--text"),s.classList.add("tidycontact-added-input"),s.setAttribute("autocomplete","off"),s.value=e,i.appendChild(s),s}hasAddressFields(){const t=this.getField(this.fields.address1),e=this.getField(this.fields.address2),i=this.getField(this.fields.city),s=this.getField(this.fields.region),n=this.getField(this.fields.postalCode),a=this.getField(this.fields.country);return!!(t||e||i||s||n||a)}createFields(){if(!this.hasAddressFields())return;const t=this.getField("supporter.geo.latitude"),e=this.getField("supporter.geo.longitude");t||(this.createHiddenInput("supporter.geo.latitude",""),this.isDebug()&&console.log("Creating Hidden Field: supporter.geo.latitude")),e||(this.createHiddenInput("supporter.geo.longitude",""),this.isDebug()&&console.log("Creating Hidden Field: supporter.geo.longitude")),this.as_record&&(this.getField(this.as_record)||(this.createHiddenInput(this.as_record,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.as_record))),this.as_date&&(this.getField(this.as_date)||(this.createHiddenInput(this.as_date,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.as_date))),this.as_status&&(this.getField(this.as_status)||(this.createHiddenInput(this.as_status,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.as_status))),this.getField(this.fields.address2)||(this.createHiddenInput(this.fields.address2,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.fields.address2)),this.getField(this.fields.address3)||(this.createHiddenInput(this.fields.address3,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.fields.address3))}createPhoneFields(){this.createHiddenInput("tc.phone.country",""),this.isDebug()&&console.log("TidyContact creating hidden field: tc.phone.country"),this.ps_record&&(this.getField(this.ps_record)||(this.createHiddenInput(this.ps_record,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.ps_record))),this.ps_date&&(this.getField(this.ps_date)||(this.createHiddenInput(this.ps_date,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.ps_date))),this.ps_status&&(this.getField(this.ps_status)||(this.createHiddenInput(this.ps_status,""),this.isDebug()&&console.log("TidyContact creating hidden field: "+this.ps_status)))}todaysDate(){return(new Date).toLocaleString("en-ZA",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\/+/g,"")}checkNested(t,e){if(void 0===t)return!1;for(var i=arguments.length,s=new Array(i>2?i-2:0),n=2;n<i;n++)s[n-2]=arguments[n];return!(0!=s.length||!t.hasOwnProperty(e))||this.checkNested(t[e],...s)}countryAllowed(t){return!(this.countries.length>0)||this.countries.includes(t.toLowerCase())}getScriptData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=document.querySelector("script[src*='cdn.tidycontact.io/engagingnetworks.js'], script[src*='tidycontact.js']");if(i){const s=i.getAttribute("data-"+t);return null!=s?s:e}return this.isDebug()&&console.error("TidyContact Script Not Found"),e}fetchTimeout(t,e){let{signal:i,...s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=new AbortController,a=fetch(t,{signal:n.signal,...s});i&&i.addEventListener("abort",(()=>n.abort()));const o=setTimeout((()=>n.abort()),1e3*e);return a.finally((()=>clearTimeout(o)))}writeError(t){const e=this.getField(this.as_record),i=this.getField(this.as_date),s=this.getField(this.as_status);if(e){let i="";switch(this.httpStatus){case 400:i="Bad Request";break;case 401:i="Unauthorized";break;case 403:i="Forbidden";break;case 404:i="Not Found";break;case 408:i="API Request Timeout";break;case 500:i="Internal Server Error";break;case 503:i="Service Unavailable";break;default:i="Unknown Error"}const s={status:this.httpStatus,error:"string"==typeof t?t:i.toUpperCase()};e.value=JSON.stringify(s)}i&&(i.value=this.todaysDate()),s&&(s.value="ERROR-API")}getCountryByCode(t){var e;const i=null!==(e=this.countries_list.find((e=>e.includes(t))))&&void 0!==e?e:"";return i?{name:i[0],code:i[1],dialCode:i[2],placeholder:i[3]}:null}phoneEnabled(){return!!this.phone_enable}countryDropDownEnabled(){return"false"!==this.phone_flags}renderFlagsDropDown(){const t=this.getField(this.fields.phone);if(!t)return;this.countries_dropdown=document.createElement("div"),this.countries_dropdown.classList.add("tc-flags-container");const e=document.createElement("div");e.classList.add("tc-selected-flag"),e.setAttribute("role","combobox"),e.setAttribute("aria-haspopup","listbox"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-owns","tc-flags-list"),e.setAttribute("aria-label","Select Country"),e.setAttribute("tabindex","0");const i=document.createElement("div");i.classList.add("tc-flag");const s=document.createElement("div");s.classList.add("tc-flag-arrow"),e.appendChild(i),e.appendChild(s),e.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),e.classList.contains("tc-open")?this.closeCountryDropDown():this.openCountryDropDown()}));const n=document.createElement("ul");if(n.classList.add("tc-country-list"),n.classList.add("tc-hide"),n.setAttribute("id","tc-country-list"),n.setAttribute("role","listbox"),n.setAttribute("aria-label","List of Countries"),n.setAttribute("aria-hidden","true"),this.phone_preferred_countries.length>0){const t=[];this.phone_preferred_countries.forEach((e=>{const i=this.getCountryByCode(e);i&&t.push(i)})),this.appendCountryItems(n,t,"tc-country-list-item",!0);const e=document.createElement("li");e.classList.add("tc-divider"),e.setAttribute("role","separator"),e.setAttribute("aria-disabled","true"),n.appendChild(e),this.isDebug()&&console.log("TidyContact rendering preferred countries",JSON.stringify(t))}const a=[];this.countries_list.forEach((t=>{a.push({name:t[0],code:t[1],dialCode:t[2],placeholder:t[3]})})),this.appendCountryItems(n,a,"tc-country-list-item"),n.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation();const e=t.target.closest("li");if(e.classList.contains("tc-country-list-item")){const t=this.getCountryByCode(e.getAttribute("data-country-code"));t&&this.setPhoneCountry(t)}})),n.addEventListener("mouseover",(t=>{t.preventDefault(),t.stopPropagation();const e=t.target.closest("li.tc-country-list-item");e&&this.highlightCountry(e.getAttribute("data-country-code"))})),this.countries_dropdown.appendChild(e),this.countries_dropdown.appendChild(n),t.parentNode.insertBefore(this.countries_dropdown,t),t.parentNode.classList.add("tc-has-country-flags"),this.countries_dropdown.addEventListener("keydown",(t=>{this.countries_dropdown.querySelector(".tc-country-list").classList.contains("tc-hide")&&-1!==["ArrowUp","Up","ArrowDown","Down"," ","Enter"].indexOf(t.key)&&(t.preventDefault(),t.stopPropagation(),this.openCountryDropDown()),"Tab"===t.key&&this.closeCountryDropDown()})),document.addEventListener("keydown",(t=>{this.countries_dropdown.querySelector(".tc-country-list").classList.contains("tc-hide")||(t.preventDefault(),"ArrowUp"===t.key||"Up"===t.key||"ArrowDown"===t.key||"Down"===t.key?this.handleUpDownKey(t.key):"Enter"===t.key?this.handleEnterKey():"Escape"===t.key&&this.closeCountryDropDown())})),document.addEventListener("click",(t=>{this.countries_dropdown.querySelector(".tc-country-list").classList.contains("tc-hide")||t.target.closest(".tc-country-list")||this.closeCountryDropDown()}))}handleUpDownKey(t){const e=this.countries_dropdown.querySelector(".tc-highlight");if(e){let i="ArrowUp"===t||"Up"===t?e.previousElementSibling:e.nextElementSibling;i&&(i.classList.contains("tc-divider")&&(i="ArrowUp"===t||"Up"===t?i.previousElementSibling:i.nextElementSibling),this.highlightCountry(i.getAttribute("data-country-code")))}}handleEnterKey(){const t=this.countries_dropdown.querySelector(".tc-highlight");if(t){const e=this.getCountryByCode(t.getAttribute("data-country-code"));this.setPhoneCountry(e)}}handlePhoneInputKeydown(t){const e=t.target.value;if("+"===e.charAt(0)&&e.length>2){const t=this.getCountryByCode(e.substring(1,3));t?this.setPhoneCountry(t):this.setDefaultPhoneCountry()}}openCountryDropDown(){if(!this.countries_dropdown)return;const t=this.countries_dropdown.querySelector(".tc-country-list"),e=this.countries_dropdown.querySelector(".tc-selected-flag");t&&e&&(t.classList.remove("tc-hide"),e.setAttribute("aria-expanded","true"),e.classList.add("tc-open"))}closeCountryDropDown(){if(!this.countries_dropdown)return;const t=this.countries_dropdown.querySelector(".tc-country-list"),e=this.countries_dropdown.querySelector(".tc-selected-flag");t&&e&&(t.classList.add("tc-hide"),e.setAttribute("aria-expanded","false"),e.classList.remove("tc-open")),this.getField(this.fields.phone).focus()}getFlagImage(t,e){return'<img loading="lazy"\n              src="https://flagcdn.com/h20/'.concat(t,'.png"\n              srcset="https://flagcdn.com/h40/').concat(t,".png 2x,\n              https://flagcdn.com/h60/").concat(t,'.png 3x"\n              height="20"\n              alt="').concat(e,'">')}appendCountryItems(t,e,i,s){let n="";for(let t=0;t<e.length;t++){const a=e[t],o=s?"-preferred":"";n+="<li class='tc-country ".concat(i,"' tabIndex='-1' id='tc-item-").concat(a.code).concat(o,"' role='option' data-dial-code='").concat(a.dialCode,"' data-country-code='").concat(a.code,"' aria-selected='false'>"),n+="<div class='tc-flag-box'><div class='tc-flag tc-".concat(a.code,"'>").concat(this.getFlagImage(a.code,a.name),"</div></div>"),n+="<span class='tc-country-name'>".concat(a.name,"</span>"),n+="<span class='tc-dial-code'>+".concat(a.dialCode,"</span>"),n+="</li>"}t.insertAdjacentHTML("beforeend",n)}setDefaultPhoneCountry(){const t=this.getField(this.fields.country);if(t){const e=t.options[t.selectedIndex].text,i=this.getCountryByCode(e);if(i)return void this.setPhoneCountry(i);if(this.phone_preferred_countries.length>0)return void this.setPhoneCountry(this.getCountryByCode(this.phone_preferred_countries[0]))}this.setPhoneCountry(this.getCountryByCode("us"))}setPhoneCountry(t){const e=this.getField("tc.phone.country");if(e.value===t.code)return;const i=this.getField(this.fields.phone);if(this.countryDropDownEnabled()){const e=this.countries_dropdown.querySelector(".tc-selected-flag"),i=this.countries_dropdown.querySelector(".tc-flag");e&&i&&(i.innerHTML=this.getFlagImage(t.code,t.name),e.setAttribute("data-country",t.code));const s=this.countries_dropdown.querySelector(".tc-country-list-item[aria-selected='true']");s&&(s.classList.remove("tc-selected"),s.setAttribute("aria-selected","false"));const n=this.countries_dropdown.querySelector(".tc-highlight");n&&n.classList.remove("tc-highlight");const a=this.countries_dropdown.querySelector(".tc-country-list-item[data-country-code='".concat(t.code,"']"));a&&(a.classList.add("tc-selected"),a.setAttribute("aria-selected","true"),a.classList.add("tc-highlight")),e.classList.contains("tc-open")&&this.closeCountryDropDown()}i.setAttribute("placeholder",t.placeholder),e.value=t.code,this.isDebug()&&console.log("TidyContact - Setting phone country to ".concat(t.code," -  ").concat(t.name))}highlightCountry(t){const e=this.countries_dropdown.querySelector(".tc-highlight");e&&e.classList.remove("tc-highlight");const i=this.countries_dropdown.querySelector(".tc-country-list");if(i){const e=i.querySelector(".tc-country[data-country-code='".concat(t,"']"));e&&(e.classList.add("tc-highlight"),e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}))}}async setPhoneDataFromAPI(t,e){const i=this.getField(this.fields.phone),s=this.getField(this.ps_record),n=this.getField(this.ps_date),a=this.getField(this.ps_status);let o=new Object;o.formData='{"'.concat(this.fields.phone,'": ').concat(i.value,"}"),o.formatted=t.formatted,o.number_type=t.number_type,!0===t.valid?(i.value!==t.formatted.e164&&(o.phone={from:i.value,to:t.formatted.e164},i.value=t.formatted.e164),await this.checkSum(JSON.stringify(o)).then((t=>{this.isDebug()&&console.log("TidyContact checksum",t),o.requestId=e,o.checksum=t})),s&&(o=Object.assign({date:this.todaysDate(),status:"SUCCESS"},o),s.value=JSON.stringify(o)),n&&(n.value=this.todaysDate()),a&&(a.value="SUCCESS")):(await this.checkSum(JSON.stringify(o)).then((t=>{this.isDebug()&&console.log("TidyContact checksum",t),o.requestId=e,o.checksum=t})),s&&(o=Object.assign({date:this.todaysDate(),status:"ERROR"},o),s.value=JSON.stringify(o)),n&&(n.value=this.todaysDate()),a&&(a.value="error"in t?"ERROR: "+t.error:"INVALIDPHONE"))}}}()}();